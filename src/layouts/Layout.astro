---
import FloatingWhatsApp from "../components/FloatingWhatsApp.astro";
import StickyCTA from "../components/StickyCTA.astro";
import { ViewTransitions } from "astro:transitions";

interface Props {
  title?: string;
  description?: string;
}

const {
  title = "Purificador de Agua en Mérida | Renta Sistema Purificación | Osmosis Inversa",
  description = "Agua purificada ilimitada en tu hogar o negocio en Mérida. Sistema de purificación por renta ✓ Osmosis inversa ✓ $0 inicial ✓ Instalación 48hrs ✓ Mantenimiento gratis ✓ Sin garrafones ✓ Servicio a domicilio",
} = Astro.props;

const baseSite = Astro.site ? Astro.site.toString() : "http://localhost:4321";
const canonicalURL = new URL(Astro.url.pathname, baseSite);
---

<!doctype html>
<html lang="es-MX">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <ViewTransitions />

    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />

    <!-- Extended Keywords for Better Ranking -->
    <meta
      name="keywords"
      content="purificador de agua, agua purificada, purificación de agua, osmosis inversa, sistema de purificación, renta purificador, purificador mérida, agua potable, filtro de agua, dispensador de agua, agua limpia, tratamiento de agua, purificador hogar, purificador oficina, garrafones, planta purificadora, filtración agua, agua embotellada, purificador domestico, servicio purificación, mantenimiento purificador, instalación purificador, purificador yucatán, agua mérida, hidratación, salud agua, calidad agua"
    />
    <meta name="author" content="Purifreze - Purificación de Agua" />
    <meta
      name="robots"
      content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"
    />
    <link rel="canonical" href={canonicalURL} />

    <!-- Geo Tags for Local SEO -->
    <meta name="geo.region" content="MX-YUC" />
    <meta name="geo.placename" content="Mérida, Yucatán, México" />
    <meta name="geo.position" content="20.9674;-89.5926" />
    <meta name="ICBM" content="20.9674, -89.5926" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content="/assets/nombre-logo.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:locale" content="es_MX" />
    <meta property="og:site_name" content="Purifreze" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content={canonicalURL} />
    <meta property="twitter:title" content={title} />
    <meta property="twitter:description" content={description} />
    <meta property="twitter:image" content="/assets/nombre-logo.png" />

    <!-- Additional SEO Tags -->
    <meta name="theme-color" content="#0066FF" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />

    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;700;800;900&display=swap"
      rel="stylesheet"
    />

    <!-- FontAwesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Animations CSS -->
    <link rel="stylesheet" href="/src/styles/animations.css" />

    <!-- Structured Data - Local Business -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "LocalBusiness",
        "@id": "https://purifreze.com",
        "name": "Purifreze",
        "description": "Renta de sistemas de purificación de agua por ósmosis inversa con instalación y mantenimiento incluido en Mérida, Yucatán",
        "url": "https://purifreze.com",
        "telephone": "+52-999-133-6108",
        "priceRange": "$$",
        "image": [
          "https://purifreze.com/assets/nombre-logo.png",
          "https://purifreze.com/assets/Casa.png",
          "https://purifreze.com/assets/Oficina.png"
        ],
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Mérida",
          "addressRegion": "Yucatán",
          "addressCountry": "MX"
        },
        "geo": {
          "@type": "GeoCoordinates",
          "latitude": "20.9674",
          "longitude": "-89.5926"
        },
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.9",
          "bestRating": "5",
          "worstRating": "1",
          "ratingCount": "500"
        },
        "openingHoursSpecification": {
          "@type": "OpeningHoursSpecification",
          "dayOfWeek": [
            "Monday",
            "Tuesday",
            "Wednesday",
            "Thursday",
            "Friday",
            "Saturday"
          ],
          "opens": "08:00",
          "closes": "18:00"
        },
        "areaServed": {
          "@type": "City",
          "name": "Mérida, Yucatán"
        },
        "serviceType": [
          "Purificación de agua",
          "Renta de purificadores",
          "Sistema de ósmosis inversa",
          "Mantenimiento de purificadores",
          "Instalación de sistemas de agua"
        ],
        "hasOfferCatalog": {
          "@type": "OfferCatalog",
          "name": "Servicios de Purificación de Agua",
          "itemListElement": [
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Purificador de Agua para Casa",
                "description": "Sistema de purificación residencial con instalación y mantenimiento incluido"
              }
            },
            {
              "@type": "Offer",
              "itemOffered": {
                "@type": "Service",
                "name": "Purificador de Agua para Oficina",
                "description": "Sistema de purificación empresarial con servicio completo"
              }
            }
          ]
        }
      }
    </script>

    <!-- Structured Data - Product/Service -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Product",
        "name": "Sistema de Purificación de Agua Purifreze",
        "description": "Sistema de purificación de agua por ósmosis inversa para renta con instalación gratis y mantenimiento incluido",
        "brand": {
          "@type": "Brand",
          "name": "Purifreze"
        },
        "offers": {
          "@type": "Offer",
          "price": "350",
          "priceCurrency": "MXN",
          "availability": "https://schema.org/InStock",
          "priceValidUntil": "2025-12-31",
          "seller": {
            "@type": "Organization",
            "name": "Purifreze"
          }
        },
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.9",
          "reviewCount": "500"
        }
      }
    </script>

    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Inicio",
            "item": "https://purifreze.com"
          }
        ]
      }
    </script>
  </head>
  <body>
    <slot />
    <FloatingWhatsApp />
    <StickyCTA />

    <script>
      // Scroll Animation Observer
      function initScrollAnimations() {
        const observerOptions = {
          root: null,
          rootMargin: "0px",
          threshold: 0.1,
        };

        const observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              entry.target.classList.add("visible");
            }
          });
        }, observerOptions);

        // Observe all elements with animation classes
        const animatedElements = document.querySelectorAll(
          ".fade-in, .slide-in-left, .slide-in-right, .scale-in",
        );
        animatedElements.forEach((el) => observer.observe(el));
      }

      // Initialize on page load
      document.addEventListener("DOMContentLoaded", initScrollAnimations);

      // Re-initialize after Astro page transitions
      document.addEventListener("astro:page-load", initScrollAnimations);
    </script>
  </body>
</html>
